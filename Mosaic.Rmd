---
title: "Workflow_cb"
output: html_document
---

The following document outlines how to manually make the mosaic plot using my function. It requires

- BEDTOOLS intersect .gff3s for AT rich and GC rich genes, TE classes, and TE orders
- Use the bedtools parameters -wa (AT/GC) and -wb (genes, TEs, order files), and make sure to include -filename for the order files. 

all functions will be found here:

```{r}
source("mosaic_functions_g.R")
```
# The files

## AT/GC files
these are the output from occultercut in gff format

## TE classes
these files are generated with the custom function rm_to_bed_tclass() with the repeatmasker .out file. 

## TE orders 
these are generated by subsetting the repeatmasker .out files custom function rm_to_bed_order()

## load in outfile then generate bed files for orders, tes, and genes. 
```{r}
Ecl_out <- read_rm_new(RMout_path("Ecl"))
```

##Usage: rm_to_bed_order("RMoutfile", subset_order = "order", "filename")
where "order" = LTR, LINE, DNA, MITE, Unknown, etc. repeat code below for each order

```{r}
write_rm_to_bed_order(RMout_path("Ecl"), subset_order = "LTR", "Ecl/repeat_beds/Ecl_LTR.bed")
```

then run each bedfiles throug bedtools intersect using AT and GC rich gffs as -a files and order beds as -b files.
Repeat this for genes and TEs too.

Load all the files using the following functions
```{r}
TE_props <- TE_proportions("Ecl", AT_TE_path("Ecl"), GC_TE_path("Ecl"))
props <- mosaic_proportions("Ecl", AT_genes_path("Ecl"), GC_genes_path("Ecl"),
                  AT_order_path("Ecl"), GC_order_path("Ecl"))

props <- cbind.data.frame(props, TE_props)
colnames(props) <- str_replace(colnames(props), "/", ".") #IMPORTANT OR FUNCTION WONT WORK
colnames(props) <- str_replace(colnames(props), "-", ".")

finally make the plot
```{r}
mosaic_plot(props) 
```


